<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SIH Schedule (12th & 13th) - MCET SRC</title>
  <style>
    :root {
      --src-yellow: #ffd700;
      --bg: #ffffff;
      --text: #222;
      --muted: #6b7280;
      --border: #e5e7eb;

      --aids: #2c5aa0;   /* blue */
      --aiml: #7b2cbf;   /* purple */
      --cse:  #d63384;   /* magenta/pink */
      --it:   #fd7e14;   /* orange */
      --auto: #2a9d8f;   /* teal for AUTO */
      --vlsi: #16a34a;   /* green for VLSI */
      --mca:  #0ea5e9;   /* cyan for MCA */
      --mech: #ef4444;   /* red for MECH */
      --cys:  #6366f1;   /* indigo for CYS */
      --civil:#8b4513;   /* brown for CIVIL */
      --eee:  #3b82f6;   /* blue for EEE department */
      --ece:  #0d9488;   /* teal for ECE department */

      --venue-cse: #e8f0ff; /* subtle pastel */
      --venue-ece: #e8fff2;
      --venue-eee: #fff3e8;
    }

    html, body {
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.4;
      margin: 0;
      padding: 0;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px;
    }

    .header {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px;
      border: 1px solid var(--border);
      border-left: 6px solid var(--src-yellow);
      border-radius: 10px;
      background: #fffef5;
    }
    .header img {
      height: 56px;
      width: auto;
    }
    .header .title {
      font-weight: 800;
      font-size: 1.4rem;
    }
    .header .subtitle {
      color: var(--muted);
      margin-top: 2px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 16px 0 0 0;
    }
    .btn {
      background: var(--src-yellow);
      border: 1px solid #e6c200;
      color: #1f2937;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    .btn:hover { filter: brightness(0.98); }

    .panel {
      margin-top: 16px;
      border: 1px solid var(--src-yellow);
      border-radius: 10px;
      background: #fff;
      padding: 12px 14px;
    }
    .panel h3 {
      margin: 0 0 8px 0;
      font-size: 1rem;
    }
    .hint { color: var(--muted); font-size: 0.9rem; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
    }
    thead th {
      background: var(--src-yellow);
      color: #1f2937;
      text-align: left;
      padding: 10px 12px;
      font-size: 0.95rem;
      border-bottom: 1px solid #e6c200;
    }
    tbody td {
      border-bottom: 1px solid var(--border);
      padding: 10px 12px;
      font-size: 0.95rem;
    }
    tbody tr:hover { background: #fffef7; }

    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 700;
      color: #fff;
    }
    .badge-aids { background: var(--aids); }
    .badge-aiml { background: var(--aiml); }
    .badge-cse  { background: var(--cse); }
    .badge-it   { background: var(--it); }
    .badge-auto { background: var(--auto); }
    .badge-vlsi { background: var(--vlsi); }
    .badge-mca  { background: var(--mca); }
    .badge-mech { background: var(--mech); }
    .badge-cys  { background: var(--cys); }
    .badge-civil{ background: var(--civil); }
    .badge-eee  { background: var(--eee); }
    .badge-ece  { background: var(--ece); }

    .venue-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.85rem;
      border: 1px solid var(--border);
    }
    .venue-cse { background: var(--venue-cse); }
    .venue-ece { background: var(--venue-ece); }
    .venue-eee { background: var(--venue-eee); }

    .kpis {
      display: grid;
      grid-template-columns: repeat(12, minmax(0,1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .kpi {
      background: #fff;
      border: 1px solid var(--border);
      border-left: 4px solid var(--src-yellow);
      border-radius: 10px;
      padding: 10px 12px;
    }
    .kpi .label { color: var(--muted); font-size: 0.85rem; }
    .kpi .value { font-weight: 800; font-size: 1.2rem; margin-top: 2px; }

    .legend {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .legend .item { display: flex; align-items: center; gap: 6px; font-size: 0.9rem; }

    @media print {
      .no-print { display: none !important; }
      body { background: #fff !important; }
      .page { max-width: none; padding: 0; }
      .panel, .kpi, table { break-inside: avoid; }
      thead { position: sticky; top: 0; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="header">
      <img src="srclogo.eeaf84bd669c (1).png" alt="MCET SRC Logo" />
      <div>
        <div class="title">MCET SRC - Smart India Hackathon 2025</div>
        <div class="subtitle">2-Day Evaluation Schedule • 12th & 13th • CSE/ECE/EEE Conference Halls</div>
      </div>
    </div>

    <div class="controls no-print">
      <button class="btn" id="btn-generate">Regenerate Schedule</button>
      <button class="btn" id="btn-print">Download PDF</button>
      <select id="sort-by" class="btn" style="background:#fff; border-color: var(--border);">
        <option value="original">Sort: Original (Chronological)</option>
        <option value="venue">Sort: Venue → Day → Time → Dept</option>
        <option value="time">Sort: Day → Time → Venue → Dept</option>
        <option value="dept">Sort: Department → Day → Time → Venue</option>
      </select>
      <button class="btn" id="btn-apply-sort">Apply Sort</button>
    </div>

    <div class="panel">
      <h3>Time Rules</h3>
      <div class="hint">
        Day 1 (12th): 10:40–13:00 → 14 teams/venue (14×10m), 13:00–13:10 → 1 team/venue (1×10m), 13:40–13:50 → 1 team/venue (1×10m), 13:50–14:00 → 1 team/venue (1×10m), 14:00–16:30 → 15 teams/venue (15×10m), 16:30–16:40 → 1 team/venue (1×10m)<br>
        Day 2 (13th): 09:00–10:30 → 9 teams/venue (9×10m), 10:40–13:00 → 14 teams/venue (14×10m), 13:00–13:10 → 1 team/venue (1×10m), 13:40–13:50 → 1 team/venue (1×10m), 13:50–14:00 → 1 team/venue (1×10m), 14:00–16:30 → 15 teams/venue (15×10m), 16:30–16:40 → 1 team/venue (1×10m). Special: 16:40–16:50 (CSE only) reserved for HackHounds (AIDS).<br>
        No gaps within blocks; slots continuous; end exactly at block end. Concurrency allowed across venues.
      </div>
    </div>

    <div class="kpis" id="summary">
      <div class="kpi"><div class="label">AIDS </div><div class="value" id="sum-aids">0</div></div>
      <div class="kpi"><div class="label">AIML </div><div class="value" id="sum-aiml">0</div></div>
      <div class="kpi"><div class="label">CSE </div><div class="value" id="sum-cse">0</div></div>
      <div class="kpi"><div class="label">IT </div><div class="value" id="sum-it">0</div></div>
      <div class="kpi"><div class="label">AUTO </div><div class="value" id="sum-auto">0</div></div>
      <div class="kpi"><div class="label">VLSI </div><div class="value" id="sum-vlsi">0</div></div>
      <div class="kpi"><div class="label">MCA </div><div class="value" id="sum-mca">0</div></div>
      <div class="kpi"><div class="label">MECH</div><div class="value" id="sum-mech">0</div></div>
      <div class="kpi"><div class="label">CYS </div><div class="value" id="sum-cys">0</div></div>
      <div class="kpi"><div class="label">CIVIL </div><div class="value" id="sum-civil">0</div></div>
      <div class="kpi"><div class="label">EEE </div><div class="value" id="sum-eee">0</div></div>
      <div class="kpi"><div class="label">ECE </div><div class="value" id="sum-ece">0</div></div>
    </div>

    <div class="legend">
      <div class="item"><span class="badge badge-aids">AIDS</span> AIDS</div>
      <div class="item"><span class="badge badge-aiml">AIML</span> AIML</div>
      <div class="item"><span class="badge badge-cse">CSE</span> CSE</div>
      <div class="item"><span class="badge badge-it">IT</span> IT</div>
      <div class="item"><span class="badge badge-auto">AUTO</span> AUTO</div>
      <div class="item"><span class="badge badge-vlsi">VLSI</span> VLSI</div>
      <div class="item"><span class="badge badge-mca">MCA</span> MCA</div>
      <div class="item"><span class="badge badge-mech">MECH</span> MECH</div>
      <div class="item"><span class="badge badge-cys">CYS</span> CYS</div>
      <div class="item"><span class="badge badge-civil">CIVIL</span> CIVIL</div>
      <div class="item"><span class="badge badge-eee">EEE</span> EEE</div>
      <div class="item"><span class="badge badge-ece">ECE</span> ECE</div>
      <div class="item"><span class="venue-badge venue-cse">CSE Conference Hall</span></div>
      <div class="item"><span class="venue-badge venue-ece">ECE Conference Hall</span></div>
      <div class="item"><span class="venue-badge venue-eee">EEE Conference Hall</span></div>
    </div>

    <table id="schedule">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Team ID</th>
          <th>Department</th>
          <th>Team Name</th>
          <th>Venue</th>
          <th>Day</th>
          <th>Time Slot</th>
        </tr>
      </thead>
      <tbody>
        <!-- Rows generated by JS -->
      </tbody>
    </table>
  </div>

  <script>
    // Helpers
    function toMinutes(hhmm) {
      const [h, m] = hhmm.split(":").map(Number);
      return h * 60 + m;
    }
    function toHHMM(mins) {
      let h = Math.floor(mins / 60);
      let m = mins % 60;
      const hh = String(h).padStart(2, '0');
      const mm = String(m).padStart(2, '0');
      return `${hh}:${mm}`;
    }

    function recipeDurations(type) {
      if (type === '12x90') {
        // 6 x 8, 6 x 7, interleaved starting with 8
        const arr = [];
        for (let i = 0; i < 6; i++) { arr.push(8, 7); }
        return arr; // length 12, sum 90
      }
      if (type === '16x140') {
        // 12 x 9 + 4 x 8; place 8s at positions 2,6,10,14 (1-indexed)
        const arr = new Array(16).fill(9);
        [2,6,10,14].forEach(p => { arr[p - 1] = 8; });
        return arr; // length 16, sum 140
      }
      if (type === '18x150') {
        // 12 x 8 + 6 x 9; put 9s at positions 2,5,8,11,14,17 (1-indexed)
        const arr = new Array(18).fill(8);
        [2,5,8,11,14,17].forEach(p => { arr[p - 1] = 9; });
        return arr; // length 18, sum 150
      }
      throw new Error('Unknown recipe');
    }

    function deptBadge(dept) {
      const map = { AIDS: 'badge-aids', AIML: 'badge-aiml', CSE: 'badge-cse', IT: 'badge-it', AUTO: 'badge-auto', VLSI: 'badge-vlsi', MCA: 'badge-mca', MECH: 'badge-mech', CYS: 'badge-cys', CIVIL: 'badge-civil', EEE: 'badge-eee', ECE: 'badge-ece' };
      const cls = map[dept] || '';
      return `<span class="badge ${cls}">${dept}</span>`;
    }

    function venueBadge(venue) {
      const map = {
        'CSE Conference Hall': 'venue-cse',
        'ECE Conference Hall': 'venue-ece',
        'EEE Conference Hall': 'venue-eee'
      };
      const cls = map[venue] || '';
      return `<span class="venue-badge ${cls}">${venue}</span>`;
    }

    // Row store and rendering
    let originalRows = [];
    let currentRows = [];
    const DAY_ORDER = { 'Day 1 (12th)': 1, 'Day 2 (13th)': 2 };

    // IDs to move: swap these IT rows (from Day 2 morning) into Day 1 by swapping with non-AIDS, non-IT teams
    const IT_MOVE_IDS = [
      'IT007','IT008','IT009','IT010','IT011','IT012','IT013','IT014','IT015',
      'IT016','IT017','IT018','IT019','IT020','IT021','IT022','IT023','IT024','IT025'
    ];

    function sortChrono(a, b) {
      return (DAY_ORDER[a.day] - DAY_ORDER[b.day]) ||
             (a.startMin - b.startMin) ||
             a.venue.localeCompare(b.venue) ||
             a.id.localeCompare(b.id);
    }

    // Swap IT ids from Day 2 to Day 1 by exchanging schedule slots with non-AIDS, non-IT rows on Day 1
    function applyCustomAdjustments(rows) {
      const usedTargets = new Set();
      for (const itId of IT_MOVE_IDS) {
        const iIdx = rows.findIndex(r => r.id === itId && r.day === 'Day 2 (13th)');
        if (iIdx === -1) continue; // not found or already moved
        const itRow = rows[iIdx];

        // Prefer same venue on Day 1, otherwise any venue
        let tIdx = rows.findIndex((r, idx) =>
          r.day === 'Day 1 (12th)' && r.dept !== 'AIDS' && r.dept !== 'IT' && r.id !== '—' &&
          r.venue === itRow.venue && !usedTargets.has(idx)
        );
        if (tIdx === -1) {
          tIdx = rows.findIndex((r, idx) =>
            r.day === 'Day 1 (12th)' && r.dept !== 'AIDS' && r.dept !== 'IT' && r.id !== '—' &&
            !usedTargets.has(idx)
          );
        }
        if (tIdx === -1) continue; // no available target

        const tRow = rows[tIdx];
        usedTargets.add(tIdx);

        // Swap schedule fields (keep teams intact)
        const tmpDay = itRow.day;     itRow.day = tRow.day;     tRow.day = tmpDay;
        const tmpStart = itRow.startMin; itRow.startMin = tRow.startMin; tRow.startMin = tmpStart;
        const tmpEnd = itRow.endMin;     itRow.endMin = tRow.endMin;     tRow.endMin = tmpEnd;
        const tmpVenue = itRow.venue;    itRow.venue = tRow.venue;       tRow.venue = tmpVenue;
      }
    }

    function renderRows(rows) {
      const tbody = document.querySelector('#schedule tbody');
      tbody.innerHTML = '';
      rows.forEach((r, idx) => {
        const tr = document.createElement('tr');

        const tdSno = document.createElement('td');
        tdSno.textContent = String(idx + 1);

        const tdId = document.createElement('td');
        tdId.textContent = r.id;

        const tdDept = document.createElement('td');
        tdDept.innerHTML = r.dept !== '—' ? deptBadge(r.dept) : '—';

        const tdName = document.createElement('td');
        tdName.textContent = r.name;

        const tdVenue = document.createElement('td');
        tdVenue.innerHTML = venueBadge(r.venue);

        const tdDay = document.createElement('td');
        tdDay.textContent = r.day;

        const tdTime = document.createElement('td');
        tdTime.textContent = `${toHHMM(r.startMin)} - ${toHHMM(r.endMin)}`;

        tr.appendChild(tdSno);
        tr.appendChild(tdId);
        tr.appendChild(tdDept);
        tr.appendChild(tdName);
        tr.appendChild(tdVenue);
        tr.appendChild(tdDay);
        tr.appendChild(tdTime);
        tbody.appendChild(tr);
      });
    }

    function applySort() {
      const mode = document.getElementById('sort-by').value;
      let rows = [...originalRows];
      const cmpStr = (a, b) => a.localeCompare(b, undefined, { sensitivity: 'base' });
      if (mode === 'venue') {
        rows.sort((a, b) =>
          cmpStr(a.venue, b.venue) ||
          (DAY_ORDER[a.day] - DAY_ORDER[b.day]) ||
          (a.startMin - b.startMin) ||
          cmpStr(a.dept, b.dept) ||
          (a.originalIndex - b.originalIndex)
        );
      } else if (mode === 'time') {
        rows.sort((a, b) =>
          (DAY_ORDER[a.day] - DAY_ORDER[b.day]) ||
          (a.startMin - b.startMin) ||
          cmpStr(a.venue, b.venue) ||
          cmpStr(a.dept, b.dept) ||
          (a.originalIndex - b.originalIndex)
        );
      } else if (mode === 'dept') {
        rows.sort((a, b) =>
          cmpStr(a.dept, b.dept) ||
          (DAY_ORDER[a.day] - DAY_ORDER[b.day]) ||
          (a.startMin - b.startMin) ||
          cmpStr(a.venue, b.venue) ||
          (a.originalIndex - b.originalIndex)
        );
      } else {
        // original
        rows.sort((a, b) => a.originalIndex - b.originalIndex);
      }
      currentRows = rows;
      renderRows(currentRows);
    }

    // Data
    const VENUES = ['CSE Conference Hall', 'ECE Conference Hall', 'EEE Conference Hall'];

    const DAYS = [
      {
        key: 'Day 1 (12th)',
        blocks: [
          { start: '10:40', end: '13:00', capacity: 14, recipe: 'fixed10' },
          { start: '13:00', end: '13:10', capacity: 1, recipe: 'fixed10' },
          { start: '13:40', end: '13:50', capacity: 1, recipe: 'fixed10' },
          { start: '13:50', end: '14:00', capacity: 1, recipe: 'fixed10' },
          { start: '14:00', end: '16:30', capacity: 15, recipe: 'fixed10' },
          { start: '16:30', end: '16:40', capacity: 1, recipe: 'fixed10' }
        ]
      },
      {
        key: 'Day 2 (13th)',
        blocks: [
          { start: '09:00', end: '10:30', capacity: 9, recipe: 'fixed10' },
          { start: '10:40', end: '13:00', capacity: 14, recipe: 'fixed10' },
          { start: '13:00', end: '13:10', capacity: 1, recipe: 'fixed10' },
          { start: '13:40', end: '13:50', capacity: 1, recipe: 'fixed10' },
          { start: '13:50', end: '14:00', capacity: 1, recipe: 'fixed10' },
          { start: '14:00', end: '16:30', capacity: 15, recipe: 'fixed10' },
          { start: '16:30', end: '16:40', capacity: 1, recipe: 'fixed10' }
        ]
      }
    ];

    // ECE team names (provided order)
    const ECE_NAMES = [
      'Gryffindors',
      'Tech Spark',
      'Techno Titans',
      'Team ForgeAlly',
      'Synersix',
      'Team Alpha',
      'HexaHive',
      'Echo Tronics',
      'InnoVision',
      'Hexals',
      'Web Weavers',
      'Team Katsuki',
      'Code Nova',
      'Source Sages',
      'Data Drifters',
      'Blossoms',
      'Hack Havoc',
      'Technocrats',
      'Code Beast',
      'Tech Titans',
      'Pentagon',
      'Phoenix',
      'Bug Hunters',
      'E.d.ith',
      'PSYCHO CRACKS',
      'VIRTUAL WARRIORS',
      'Hackowants - Karthick srujan',
      'Logic lords',
      'PIXEL pioneers',
      'Tech innovators',
      'Binary brains',
      'Capcitive minds',
      'Quantum dots'
    ];

    // AIDS team names (preserving provided order)
    const AIDS_NAMES = [
      'Team loosers',
      'Spark squad',
      'Innovatrix',
      'Dataminds',
      'Akatsuki',
      'Brogrammers',
      'Codehex',
      'Crt Alt Elite',
      'Dark programmers',
      'Green thumbs',
      'Renova',
      'Synora',
      'Team basha',
      'Team jiraiya',
      'Think tankers',
      'Innovatvex',
      'Innovators',
      'Quantum hustle',
      '404 Not Found',
      'Jambusters',
      'Nova minds',
      'Sixthsense crew',
      'Skywalkers',
      'Techno sparkers',
      'Who am I',
      'Team wizards',
      'Tech icons',
      'Codehunters',
      'Bluestar',
      'Tech innovators',
      'Innosparks',
      'Technova',
      'TeenTitans',
      'Hackers united',
      'Tech paltans',
      'Code4Care',
      'Innovix',
      'Tech Psywell Nexus',
      'Tech sparks',
      'Byte Shifters',
      'Flyers',
      'Terra Titans',
      'TempX Workforce',
      'Neural ninjas',
      'HackHounds'
    ].map(s => s.trim());

    // AUTO team names (provided order)
    const AUTO_NAMES = [
      'Ankers Auto',
      'G-Spark Auto',
      'NextGenAutotech',
      'Synergy Auto',
      'Team Tenacity',
      'Tech Shori'
    ];

    // VLSI team names (provided order)
    const VLSI_NAMES = [
      'Silicon Squad',
      'Electra Hub',
      'Aura',
      'The Radio Actives',
      'Greenguardians',
      'Agrivision',
      'Proto Pirates',
      'Globecoders',
      'Hexagun',
      'Innowiz',
      'Team Dharshan.K VLSI',
      'Axion',
      'Inno Vengers',
      'Bug Busters',
      'Inno Minds'
    ];

    // MCA team names (provided order)
    const MCA_NAMES = [
      'TEAM BUG BUSTERS',
      'Code zone1',
      'Codex1',
      'Hackaholics',
      'Nexus 1',
      'Shecodes1',
      'Tech falcon1',
      'TycoonSquard1'
    ];

    // MECH team names (provided order)
    const MECH_NAMES = [
      '404 Not Found',
      'Drag Fist',
      'Group of 6 (G6)',
      'Hack Hard',
      'Innovex 25',
      'Mechbharatinnovators',
      'Sparkers'
    ];

    // CYS team names (provided order)
    const CYS_NAMES = [
      'Clarentzz',
      'CYBER_NEXUS',
      'CYBEROCKS',
      'Enigma',
      'Fireflies',
      'HACKHARMONY',
      'MIND_MASTERS',
      'Straw_hats',
      'Tech Creators'
    ];

    // CIVIL team names (provided order)
    const CIVIL_NAMES = [
      'Tech Cilians',
      'The Pillars',
      'Purezza',
      'Fight Club',
      'Power House',
      'Strawhats',
      'Ruled Out'
    ];

    // EEE team names (provided order)
    const EEE_NAMES = [
      'G6',
      'Gryffindors',
      'Hacksix',
      'Thunder Bolts',
      'Vision Vortex',
      'Automators',
      'Electro Titans_MT',
      'Spectra',
      'Team Jagadhesan B(EEE)',
      'The Silicon Stack',
      'Hackaholics',
      'Blue Print',
      'Nexus Rebels',
      'Celestial 6',
      'Warriors',
      'Rough Paths',
      'Sparkers',
      'Super Nova',
      'Sparkers',
      'Spark Innovators'
    ];

    // Placeholder teams for AIML (16), CSE (35), IT (25)
    function makePlaceholders(prefix, count) {
      const arr = [];
      for (let i = 1; i <= count; i++) {
        arr.push(`${prefix} Team ${String(i).padStart(3, '0')}`);
      }
      return arr;
    }
    const AIML_NAMES = [
      'APEXGP',
      'CodeBlasters',
      'Hackfinity',
      'Hackoverdrive',
      'Neurobytes',
      'Quantum Quants',
      'Rocknet',
      'squee',
      'Sybapsters',
      'Team Draft',
      'Team_Binary',
      'Tech avatars',
      'Tech Squad',
      'Tech_Hackers',
      'THE ESPADA',
      'WISHFUL_WARRIORS'
    ].map(s => s.trim());
    const CSE_NAMES  = [
      'BUG BRIAN',
      'Bytebattlers',
      'CODESMITHS',
      'CODEX',
      'TECH NINJAS',
      'TechNovaX',
      'TechSpark',
      'TechTrack',
      'CYPHERX',
      'Fixora',
      'HACKMASTERS',
      'HACKOVATORS',
      'INNO MINDS',
      'INNOVERSE',
      'Nexus',
      'PATHMARKER',
      'PHANTOM',
      'PIXEL',
      'RUNTIME TERRORS',
      'SARPATTA',
      'SIXTECHS',
      'STACKOVERFLOWED',
      'Tech avengers',
      'TECH BLINDERS',
      'Tech Learners',
      'TECH NINJAS',
      'TECH TRACK',
      'TECH CSE2',
      'Technotitans',
      'TECHNOVAX',
      'Techsparks',
      'Techtitans',
      'The Daltons',
      'Thinkbuye',
      'TRACKGUARDIAN'
    ].map(s => s.trim());
    const IT_NAMES   = [
      'Shazam',
      'Tech_Dragons',
      'TECHNOBLADE',
      'TECH WIZARDS',
      'TECH HOLICS',
      'TECH TITANS II',
      'SOLUTATORS',
      'EMERGING STARS',
      'Team Luna',
      'Tech Trojans',
      'Byte beakers',
      'Codezillas',
      'Hackfinity',
      'SparkMinds',
      'Gear6Coders',
      'ERROR-404',
      'CodeCrafters',
      'Achievers',
      'Technode',
      'TECH HUNTERS',
      'TECH TITANS',
      'BYTE KARMA',
      'Innovation exists here',
      'TechSpark',
      'Code4Change'
    ].map(s => s.trim());

    // Build the ordered team queue preserving department ordering: AIDS -> AIML -> CSE -> IT -> AUTO -> VLSI -> MCA -> MECH -> CYS -> CIVIL -> EEE -> ECE (fills prior open slots)
    function makeTeams() {
      const teams = [];
      // AIDS 45
      AIDS_NAMES.forEach((name, idx) => {
        const id = `AIDS${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'AIDS', name });
      });
      // AIML 16
      AIML_NAMES.forEach((name, idx) => {
        const id = `AIML${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'AIML', name });
      });
      // CSE 35
      CSE_NAMES.forEach((name, idx) => {
        const id = `CSE${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'CSE', name });
      });
      // IT 25
      IT_NAMES.forEach((name, idx) => {
        const id = `IT${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'IT', name });
      });
      // AUTO 6
      AUTO_NAMES.forEach((name, idx) => {
        const id = `AUTO${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'AUTO', name });
      });
      // VLSI 15
      VLSI_NAMES.forEach((name, idx) => {
        const id = `VLSI${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'VLSI', name });
      });
      // MCA 8
      MCA_NAMES.forEach((name, idx) => {
        const id = `MCA${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'MCA', name });
      });
      // MECH 7
      MECH_NAMES.forEach((name, idx) => {
        const id = `MECH${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'MECH', name });
      });
      // CYS 9
      CYS_NAMES.forEach((name, idx) => {
        const id = `CYS${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'CYS', name });
      });
      // CIVIL 7
      CIVIL_NAMES.forEach((name, idx) => {
        const id = `CIVIL${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'CIVIL', name });
      });
      // EEE 20
      EEE_NAMES.forEach((name, idx) => {
        const id = `EEE${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'EEE', name });
      });
      // ECE 33
      ECE_NAMES.forEach((name, idx) => {
        const id = `ECE${String(idx + 1).padStart(3, '0')}`;
        teams.push({ id, dept: 'ECE', name });
      });
      return teams;
    }

    function generateSchedule() {
      const tbody = document.querySelector('#schedule tbody');
      tbody.innerHTML = '';

      originalRows = [];
      currentRows = [];

      const teamQueue = makeTeams();
      let qIndex = 0;

      const placedCounter = { AIDS: 0, AIML: 0, CSE: 0, IT: 0, AUTO: 0, VLSI: 0, MCA: 0, MECH: 0, CYS: 0, CIVIL: 0, EEE: 0, ECE: 0 };

      const rows = [];

      // Extra reserved windows to place leftover teams (applies to both days across all venues)
      const RESERVED_WINDOWS = [
        { start: toMinutes('13:00'), end: toMinutes('13:10') },
        { start: toMinutes('13:40'), end: toMinutes('13:50') },
        { start: toMinutes('13:50'), end: toMinutes('14:00') },
        { start: toMinutes('16:30'), end: toMinutes('16:40') }
      ];
      function isReservedWindow(start, end) {
        return RESERVED_WINDOWS.some(w => w.start === start && w.end === end);
      }
      const extraRows = []; // rows reserved for leftovers

      for (const day of DAYS) {
        for (const block of day.blocks) {
          const startMinBlock = toMinutes(block.start);
          // Build durations: fixed 10-minute slots or legacy recipe
          const durations = (block.recipe === 'fixed10')
            ? new Array(block.capacity).fill(10)
            : recipeDurations(block.recipe);
          // Validate sums align block window exactly
          const sum = durations.reduce((a, b) => a + b, 0);
          const endMinBlock = toMinutes(block.end);
          if (startMinBlock + sum !== endMinBlock) {
            console.warn('Recipe sum mismatch for block', day.key, block);
          }

          for (const venue of VENUES) {
            let cursor = startMinBlock;
            for (let i = 0; i < durations.length; i++) {
              const dur = durations[i];
              const start = cursor;
              const end = start + dur;
              cursor = end;

              let team = null;
              let reserveForLeftover = isReservedWindow(start, end);
              if (!reserveForLeftover) {
                if (qIndex < teamQueue.length) {
                  team = teamQueue[qIndex++];
                  placedCounter[team.dept]++;
                }
              }

              const originalIndex = rows.length;
              const row = {
                originalIndex,
                id: team ? team.id : '—',
                dept: team ? team.dept : '—',
                name: team ? team.name : (reserveForLeftover ? 'Reserved Slot' : 'Open Slot'),
                venue,
                day: day.key,
                startMin: start,
                endMin: end
              };
              rows.push(row);
              if (reserveForLeftover) {
                extraRows.push(row);
              }
            }
          }
        }
      }

      // After filling normal slots, place leftover teams into the reserved 13:50–14:00 slots
      const leftoverTeams = teamQueue.slice(qIndex);
      for (let i = 0; i < extraRows.length && i < leftoverTeams.length; i++) {
        const r = extraRows[i];
        const t = leftoverTeams[i];
        r.id = t.id;
        r.dept = t.dept;
        r.name = t.name;
        placedCounter[t.dept]++;
      }

      // Special handling: Move HackHounds (AIDS) to a single special slot on Day 2 (13th) 16:40–16:50 in CSE,
      // and swap its original slot with the next leftover team (if any remains beyond those placed into reserved windows).
      const hackIdx = rows.findIndex(r => r.name === 'HackHounds' && r.dept === 'AIDS');
      if (hackIdx !== -1) {
        const usedFromLeftovers = Math.min(extraRows.length, leftoverTeams.length);
        const swapCandidate = teamQueue[qIndex + usedFromLeftovers];
        const hackId = rows[hackIdx].id;
        if (swapCandidate) {
          // Replace HackHounds' original placement with the swap candidate
          placedCounter['AIDS'] = Math.max(0, placedCounter['AIDS'] - 1);
          rows[hackIdx].id = swapCandidate.id;
          rows[hackIdx].dept = swapCandidate.dept;
          rows[hackIdx].name = swapCandidate.name;
          placedCounter[swapCandidate.dept]++;
        } else {
          // No extra leftover team; clear original row
          placedCounter['AIDS'] = Math.max(0, placedCounter['AIDS'] - 1);
          rows[hackIdx].id = '—';
          rows[hackIdx].dept = '—';
          rows[hackIdx].name = 'Open Slot';
        }

        // Add special single slot (CSE only)
        rows.push({
          originalIndex: rows.length,
          id: hackId,
          dept: 'AIDS',
          name: 'HackHounds',
          venue: 'CSE Conference Hall',
          day: 'Day 2 (13th)',
          startMin: toMinutes('16:40'),
          endMin: toMinutes('16:50')
        });
        placedCounter['AIDS']++;
      }

      // Apply requested swaps (move selected IT rows to Day 1 by swapping with non-AIDS, non-IT rows)
      applyCustomAdjustments(rows);

      // Ensure chronological order becomes the new original order
      rows.sort(sortChrono);
      rows.forEach((r, idx) => { r.originalIndex = idx; });

      originalRows = rows;
      currentRows = [...rows];
      renderRows(currentRows);

      // Update summary
      document.getElementById('sum-aids').textContent = placedCounter.AIDS;
      document.getElementById('sum-aiml').textContent = placedCounter.AIML;
      document.getElementById('sum-cse').textContent = placedCounter.CSE;
      document.getElementById('sum-it').textContent = placedCounter.IT;
      document.getElementById('sum-auto').textContent = placedCounter.AUTO;
      document.getElementById('sum-vlsi').textContent = placedCounter.VLSI;
      document.getElementById('sum-mca').textContent = placedCounter.MCA;
      document.getElementById('sum-mech').textContent = placedCounter.MECH;
      document.getElementById('sum-cys').textContent = placedCounter.CYS;
      document.getElementById('sum-civil').textContent = placedCounter.CIVIL;
      document.getElementById('sum-eee').textContent = placedCounter.EEE;
      document.getElementById('sum-ece').textContent = placedCounter.ECE;
    }

    // Wire up buttons
    document.getElementById('btn-generate').addEventListener('click', generateSchedule);
    document.getElementById('btn-print').addEventListener('click', () => {
      window.print();
    });
    document.getElementById('btn-apply-sort').addEventListener('click', applySort);
    document.getElementById('sort-by').addEventListener('change', (e) => {
      // Auto-apply sort on change for convenience
      applySort();
    });

    // Initial render
    generateSchedule();
  </script>
</body>
</html>
